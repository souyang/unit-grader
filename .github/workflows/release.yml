name: Deployment

on:
    release:
        types: [published]
    workflow_dispatch: # Allows you to run this workflow manually from the Actions tab
jobs:
    build:
        runs-on: ${{ matrix.os }}
        strategy:
          matrix:
            python-version: ["3.9"]
            os: ["ubuntu-latest"]

        steps:
            - name: Checkout Repository
              uses: actions/checkout@v2
        
            - name: Set up PDM
              uses: pdm-project/setup-pdm@v3
              with:
                python-version: ${{ matrix.python-version }}
                cache: true
                cache-dependency-path: '**/pdm.lock'
            
            - name: Install dependencies
              run: pdm sync

  
            - name: Build and Publish to PyPI
              if: github.ref == 'refs/heads/main'
              run: |
                pdm publish --username ${{ secrets.PYPI_USERNAME }} --password ${{ secrets.PYPI_PASSWORD }}              